/*! Copyright (c) 2008 Brandon Aaron (http://brandonaaron.net)
 */
!function(e){e.extend(e.fn,{livequery:function(t,i,n){var u,r=this;return e.isFunction(t)&&(n=i,i=t,t=void 0),e.each(e.livequery.queries,function(e,s){return r.selector!=s.selector||r.context!=s.context||t!=s.type||i&&i.$lqguid!=s.fn.$lqguid||n&&n.$lqguid!=s.fn2.$lqguid?void 0:(u=s)&&!1}),u=u||new e.livequery(this.selector,this.context,t,i,n),u.stopped=!1,u.run(),this},expire:function(t,i,n){var u=this;return e.isFunction(t)&&(n=i,i=t,t=void 0),e.each(e.livequery.queries,function(r,s){u.selector!=s.selector||u.context!=s.context||t&&t!=s.type||i&&i.$lqguid!=s.fn.$lqguid||n&&n.$lqguid!=s.fn2.$lqguid||this.stopped||e.livequery.stop(s.id)}),this}}),e.livequery=function(t,i,n,u,r){return this.selector=t,this.context=i||document,this.type=n,this.fn=u,this.fn2=r,this.elements=[],this.stopped=!1,this.id=e.livequery.queries.push(this)-1,u.$lqguid=u.$lqguid||e.livequery.guid++,r&&(r.$lqguid=r.$lqguid||e.livequery.guid++),this},e.livequery.prototype={stop:function(){var e=this;this.type?this.elements.unbind(this.type,this.fn):this.fn2&&this.elements.each(function(t,i){e.fn2.apply(i)}),this.elements=[],this.stopped=!0},run:function(){if(!this.stopped){var t=this,i=this.elements,n=e(this.selector,this.context),u=n.not(i);this.elements=n,this.type?(u.bind(this.type,this.fn),i.length>0&&e.each(i,function(i,u){e.inArray(u,n)<0&&e.event.remove(u,t.type,t.fn)})):(u.each(function(){t.fn.apply(this)}),this.fn2&&i.length>0&&e.each(i,function(i,u){e.inArray(u,n)<0&&t.fn2.apply(u)}))}}},e.extend(e.livequery,{guid:0,queries:[],queue:[],running:!1,timeout:null,checkQueue:function(){if(e.livequery.running&&e.livequery.queue.length)for(var t=e.livequery.queue.length;t--;)e.livequery.queries[e.livequery.queue.shift()].run()},pause:function(){e.livequery.running=!1},play:function(){e.livequery.running=!0,e.livequery.run()},registerPlugin:function(){e.each(arguments,function(t,i){if(e.fn[i]){var n=e.fn[i];e.fn[i]=function(){var t=n.apply(this,arguments);return e.livequery.run(),t}}})},run:function(t){void 0!=t?e.inArray(t,e.livequery.queue)<0&&e.livequery.queue.push(t):e.each(e.livequery.queries,function(t){e.inArray(t,e.livequery.queue)<0&&e.livequery.queue.push(t)}),e.livequery.timeout&&clearTimeout(e.livequery.timeout),e.livequery.timeout=setTimeout(e.livequery.checkQueue,20)},stop:function(t){void 0!=t?e.livequery.queries[t].stop():e.each(e.livequery.queries,function(t){e.livequery.queries[t].stop()})}}),e.livequery.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass","empty","remove"),e(function(){e.livequery.play()});var t=e.prototype.init;e.prototype.init=function(e,i){var n=t.apply(this,arguments);return e&&e.selector&&(n.context=e.context,n.selector=e.selector),"string"==typeof e&&(n.context=i||document,n.selector=e),n},e.prototype.init.prototype=e.prototype}(jQuery);
